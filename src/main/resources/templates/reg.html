<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>注册</title>
    <link rel="stylesheet" href="/element-ui-2.13.2.css">
    <script src="/vue.js"></script>
    <script src="/axios.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>

</head>
<body>
<div id="app">
    <div>
        <el-form :model="adminForm" status-icon :rules="rules" ref="ruleForm" label-width="100px" class="demo-ruleForm">
            <el-form-item label="管理员账户" prop="adminAccount" >
                <el-input v-model.number="adminForm.adminAccount"></el-input>
            </el-form-item>

            <el-form-item label="密码" prop="adminPwd" >
                <el-input type="password" v-model="adminForm.adminPwd"></el-input>
            </el-form-item>

            <el-form-item label="确认密码" prop="checkPass" >
                <el-input type="password" v-model="adminForm.checkPass"></el-input>
            </el-form-item>

            <el-form-item label="真实姓名" prop="adminName" width="50px">
                <el-input v-model="adminForm.adminName"></el-input>
            </el-form-item>

            <el-form-item label="手机号" prop="adminPhone">
                <el-input v-model="adminForm.adminPhone"></el-input>
            </el-form-item>

            <el-form-item label="确认手机号" prop="checkPhone">
            <el-input  v-model="adminForm.checkPhone"></el-input>
        </el-form-item>


            <el-form-item>
                <el-button type="primary" @click="submitForm('ruleForm')">提交</el-button>
                <el-button @click="resetForm('ruleForm')">重置</el-button>
            </el-form-item>

        </el-form>


    </div>


</div>


    <script>
        var vm = new Vue({
           el:'#app',
           data(){

               var validatePass = (rule, value, callback) => {
                   if (value === '') {
                       callback(new Error('请输入密码'));
                   } else {
                       if (this.adminForm.checkPass !== '') {
                           this.$refs.adminForm.validateField('checkPass');
                       }
                       callback();
                   }
               };

               var validatePass2 = (rule, value, callback) => {
                   if (value === '') {
                       callback(new Error('请再次输入密码'));
                   } else if (value !== this.adminForm.adminPwd) {
                       callback(new Error('两次输入密码不一致!'));
                   } else {
                       callback();
                   }
               };

               var validatePhone = (rule, value, callback) => {
                   if (value === '') {
                       callback(new Error('请输入手机号'));
                   } else {
                       if (this.adminForm.checkPhone !== '') {
                           this.$refs.adminForm.validateField('checkPhone');
                       }
                       callback();
                   }
               };

               var validatePhone2 = (rule, value, callback) => {
                   if (value === '') {
                       callback(new Error('请再次输入手机号'));
                   } else if (value !== this.adminForm.adminPhone) {
                       callback(new Error('两次输入手机号不一致!'));
                   } else {
                       callback();
                   }
               };

               return{
                   adminForm: {
                       adminAccount: '',
                       adminPwd: '',
                       adminName: '',
                       adminPhone:'',
                       checkPass:'',
                       checkPhone:''
               },
                   rules: {
                       pass: [
                           {validator: validatePass, trigger: 'blur'}
                       ],
                       checkPass: [
                           {validator: validatePass2, trigger: 'blur'}
                            ],
                       phone: [
                           {validator: validatePhone, trigger: 'blur'}
                       ],
                       checkPhone: [
                           {validator: validatePhone2, trigger: 'blur'}
                            ],
                        }
                   }
               },
            methods:{
                submitForm(ruleForm) {
                    console.log(ruleForm)
                    this.$refs[ruleForm].validate((valid) => {
                        if (valid) {
                            //alert('submit!执行axios,提交到后台');
                            //1.获取表单内容
                            //2.提交给后台
                            alert('注册成功')
                            window.location.href="/page/login"
                            axios.post('/admin/reg',
                                this.adminForm
                            ).then(res=>{
                               console.log(res)
                            })

                        } else {
                            console.log('error submit!!');
                    return false;
                }
                });
                },
                resetForm(ruleForm) {
                    this.$refs[ruleForm].resetFields();
                }
            }
        });
    </script>
</body>
</html>